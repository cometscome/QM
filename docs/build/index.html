<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Juliaで学ぶ量子力学 · Juliaで学ぶ量子力学</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Juliaで学ぶ量子力学</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Juliaで学ぶ量子力学</a><ul class="internal"><li><a class="tocitem" href="#シュレーディンガー方程式の解-1"><span>シュレーディンガー方程式の解</span></a></li><li><a class="tocitem" href="#次元シュレーディンガー方程式の数値的解法-1"><span>1次元シュレーディンガー方程式の数値的解法</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Juliaで学ぶ量子力学</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Juliaで学ぶ量子力学</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cometscome/QM/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Juliaで学ぶ量子力学-1"><a class="docs-heading-anchor" href="#Juliaで学ぶ量子力学-1">Juliaで学ぶ量子力学</a><a class="docs-heading-anchor-permalink" href="#Juliaで学ぶ量子力学-1" title="Permalink"></a></h1><p>時間に依存しないシュレーディンガー方程式を解いてみよう。   数値計算的な考え方でシュレーディンガー方程式を眺めてみる。</p><h2 id="シュレーディンガー方程式の解-1"><a class="docs-heading-anchor" href="#シュレーディンガー方程式の解-1">シュレーディンガー方程式の解</a><a class="docs-heading-anchor-permalink" href="#シュレーディンガー方程式の解-1" title="Permalink"></a></h2><p>一次元系のシュレーディンガー方程式は、</p><div>\[\left( -\frac{\hbar^2}{2m}\frac{d^2}{dx^2} + V(x) \right) \psi(x) = \epsilon \psi(x)\]</div><p>と書ける。この方程式は二階微分方程式なので、一般解には二つの未定定数が含まれ、それらの定数を決定するためには、この方程式の他に二つの方程式が必要となる。  </p><h3 id="標準的なやり方-1"><a class="docs-heading-anchor" href="#標準的なやり方-1">標準的なやり方</a><a class="docs-heading-anchor-permalink" href="#標準的なやり方-1" title="Permalink"></a></h3><h4 id="未定定数-1"><a class="docs-heading-anchor" href="#未定定数-1">未定定数</a><a class="docs-heading-anchor-permalink" href="#未定定数-1" title="Permalink"></a></h4><p>これをはっきりさせるため、一番簡単な場合(<span>$V(x)=0)$</span>を考えてみよう。   この時のシュレーディンガー方程式は</p><div>\[ -\frac{\hbar^2}{2m}\frac{d^2}{dx^2} \psi(x) = \epsilon \psi(x)\]</div><p>となる。 この方程式の解として指数関数：</p><div>\[\psi(x) = e^{i k x}\]</div><p>を仮定すると、</p><div>\[ \frac{\hbar^2 k^2}{2m}  e^{i k x}= \epsilon  e^{i k x}\]</div><p>となるので、</p><div>\[\frac{\hbar^2 k^2}{2m} = \epsilon\]</div><p>すなわち、</p><div>\[k = \pm \frac{\sqrt{2m \epsilon}}{\hbar}\]</div><p>が得られる。以上から、二つの関数</p><div>\[\exp \left[ i \frac{\sqrt{2m \epsilon}}{\hbar} x \right], \exp \left[ -i \frac{\sqrt{2m \epsilon}}{\hbar} x \right]\]</div><p>が方程式の解であることがわかった。 そして、容易に確認出来るように、二つの解を足した解も解である。つまり、</p><div>\[\psi(x) = C_1 \exp \left[ i \frac{\sqrt{2m \epsilon}}{\hbar} x \right] + C_2 \exp \left[ -i \frac{\sqrt{2m \epsilon}}{\hbar} x \right]\]</div><p>も解である。よって、解は<span>$C_1$</span>と<span>$C_2$</span>という未定定数を二つ持つことがわかった。 これは、上述したように、方程式が二階微分方程式であるからである。   また、エネルギー<span>$\epsilon$</span>には、現時点では何も条件が課されていないため、任意の実数を取ることができる。 そしで、もし<span>$\epsilon &lt; 0$</span>であれば、<span>$k$</span>は純虚数となる。</p><h4 id="境界条件-1"><a class="docs-heading-anchor" href="#境界条件-1">境界条件</a><a class="docs-heading-anchor-permalink" href="#境界条件-1" title="Permalink"></a></h4><p>上述の解の係数を決めたい。   まず、波動関数の絶対値の二乗は粒子を見出す確率であるので、全空間で粒子を見出す確率は1にならなければならない。 つまり、</p><div>\[\int dx |\psi(x)|^2 = 1\]</div><p>である。これを規格化と呼ぶ。 この条件により、未定定数のうち一つが求まることになる。ここでの積分範囲は、考えている系全体である。  </p><h5 id="片側に壁が存在する場合-1"><a class="docs-heading-anchor" href="#片側に壁が存在する場合-1">片側に壁が存在する場合</a><a class="docs-heading-anchor-permalink" href="#片側に壁が存在する場合-1" title="Permalink"></a></h5><p><span>$x=0$</span>に壁が存在する場合(<span>$\psi(x=0)=0$</span>)を考えよう。この場合、</p><div>\[C_1 = - C_2\]</div><p>である必要があり、</p><div>\[\psi(x) = C_1 \left[ \exp \left[ i \frac{\sqrt{2m \epsilon}}{\hbar} x \right] -  \exp \left[ -i \frac{\sqrt{2m \epsilon}}{\hbar} x \right] \right] = 2 i C_1 \sin  \frac{\sqrt{2m \epsilon}}{\hbar} x\]</div><p>となる。ここで、エネルギー<span>$\epsilon$</span>が負の時、sin関数はsinh関数となり、<span>$x \rightarrow \infty$</span>で値が発散してしまう。従って、</p><div>\[\epsilon \ge 0\]</div><p>という条件が存在する。そして、エネルギーは連続の値を取ることができる。</p><h5 id="両側に壁が存在する場合-1"><a class="docs-heading-anchor" href="#両側に壁が存在する場合-1">両側に壁が存在する場合</a><a class="docs-heading-anchor-permalink" href="#両側に壁が存在する場合-1" title="Permalink"></a></h5><p><span>$x=0$</span>と<span>$x=L$</span>に壁が存在する場合(<span>$\psi(x=0)=\psi(x=L)=0$</span>)を考えよう。 片側の壁の条件は全く同じなので、</p><div>\[C_1 = - C_2\]</div><p>であり、解は</p><div>\[\psi(x) = C_1 \left[ \exp \left[ i \frac{\sqrt{2m \epsilon}}{\hbar} x \right] -  \exp \left[ -i \frac{\sqrt{2m \epsilon}}{\hbar} x \right] \right] = 2 i C_1 \sin  \frac{\sqrt{2m \epsilon}}{\hbar} x\]</div><p>である。 しかし、この解は<span>$\psi(x=L)=0$</span>を常に満たすわけではない。常に満たすためには、</p><div>\[\frac{\sqrt{2m \epsilon}}{\hbar}L = n \pi\]</div><p>である必要がある。ここで、<span>$n$</span>は1以上の整数である。もし、<span>$n=0$</span>なら解は常に0になってしまう。よって、</p><div>\[\epsilon = n^2 \frac{\hbar^2 \pi^2}{2m L^2}\]</div><p>となる。  </p><hr/><h5 id="補足：エネルギーが実数である意味-1"><a class="docs-heading-anchor" href="#補足：エネルギーが実数である意味-1">補足：エネルギーが実数である意味</a><a class="docs-heading-anchor-permalink" href="#補足：エネルギーが実数である意味-1" title="Permalink"></a></h5><p>実は、上述のような解き方では<span>$\epsilon$</span>は複素数であっても構わない。 これは、時間に依存しないシュレーディンガー方程式のみを考えているからである。   もともとの時間依存するシュレーディンガー方程式は</p><div>\[i \hbar \frac{\partial}{\partial t} \Psi(x,t) = \left(  -\frac{\hbar^2}{2m}\frac{\partial^2}{\partial x^2} + V(x) \right) \Psi(x,t)\]</div><p>であった。ここで、ポテンシャル<span>$V(x)$</span>が時間に依存しないとすれば、この偏微分方程式は変数分離することができて、解は</p><div>\[\Psi(x,t) = f(t) \psi(x)\]</div><p>と書け、微分方程式は</p><div>\[\frac{1}{f(t)} i \hbar \frac{\partial}{\partial t} f(t)  = \frac{1}{\psi(x)} \left(  -\frac{\hbar^2}{2m}\frac{\partial^2}{\partial x^2} + V(x) \right) \psi(x) = {\it const}.\]</div><p>となり、右辺の定数を<span>$\epsilon$</span>とおけば、</p><div>\[f(t) = \exp \left(-i\frac{\epsilon}{\hbar}t \right)\]</div><p>が得られる。   もし、<span>$\epsilon$</span>が複素数であり、虚部が含まれれば、<span>$f(t)$</span>は時間につれて発散あるいは減少する指数関数となり、 解は安定しない。つまり、定常状態の解にはならない。よって、<span>$\epsilon$</span>は実数である必要がある。</p><h3 id="行列とベクトル-1"><a class="docs-heading-anchor" href="#行列とベクトル-1">行列とベクトル</a><a class="docs-heading-anchor-permalink" href="#行列とベクトル-1" title="Permalink"></a></h3><p>上述したやり方だと、解の形を指数関数に仮定した。より複雑な問題に対応するためには、どのようにやるのが良いだろうか。   まず、シュレーディンガー方程式を</p><div>\[H \psi(x) = \epsilon \psi(x)\]</div><p>と書く。ここで、</p><div>\[H = \left( -\frac{\hbar^2}{2m}\frac{d^2}{dx^2} + V(x) \right) \]</div><p>である。 このような形で書くと、シュレーディンガー方程式は、ハミルトニアン<span>$H$</span>に対する固有値問題であることがわかる。 そして、エネルギーは固有値であり、対応する解は固有関数である。 異なる固有値に属する固有関数は直交し、波動関数の二乗は確率を表すため、規格化されている。つまり、 ある固有値<span>$\epsilon_n$</span>に属する解を<span>$\psi_n(x)$</span>とすると、</p><div>\[\int dx \psi_n(x)^{\ast} \psi_m(x) = \delta_{nm} \]</div><p>となる。これは、直交規格化条件である。ここで、<span>$\delta_{nm}$</span>はクロネッカーのデルタと呼ばれ、<span>$n=m$</span>の時1、<span>$n\neq m$</span>の時0となる関数である。</p><h4 id="基底の変換とベクトル表示-1"><a class="docs-heading-anchor" href="#基底の変換とベクトル表示-1">基底の変換とベクトル表示</a><a class="docs-heading-anchor-permalink" href="#基底の変換とベクトル表示-1" title="Permalink"></a></h4><p>さて、シュレーディンガー方程式の解をフーリエ変換で求めてみよう。ある関数<span>$\psi(x)$</span>のフーリエ変換は</p><div>\[\psi(x) = \int dk e^{i k x} c_k\]</div><p>と書ける。    これを<span>$V(x)=0$</span>のシュレーディンガー方程式に代入すると、</p><div>\[\int dk \frac{\hbar^2 k^2}{2m} e^{i k x} c_k = \epsilon \int dk e^{i k x} c_k\]</div><p>となり、</p><div>\[\int dx e^{- i k&#39; x}\int dk \frac{\hbar^2 k^2}{2m} e^{i k x} c_k = \epsilon \int dx e^{- i k&#39; x} \int dk e^{i k x} c_k\]</div><div>\[\frac{\hbar^2 k^2}{2m}c_k = \epsilon c_k \]</div><p>となるので、</p><div>\[\epsilon = \frac{\hbar^2 k^2}{2m}\]</div><p>であれば、解となることがわかる。</p><p>次に、フーリエ変換の積分を和とみなすと、幅<span>$dk$</span>、高さ<span>$e^{i k x} c_k$</span>の長方形の面積の和となり、</p><div>\[\psi(x) = \sum_k c_k e^{i k x} \]</div><p>となる。ここで、<span>$dk$</span>は<span>$c_k$</span>を再定義することで押し付けた。   さて、この形を眺めるとあることに気がつくかもしれない。   線形代数において、ある行列<span>$A$</span>とベクトル<span>${\bf v}$</span>の積でできたベクトル<span>${\bf g} = A{\bf v}$</span>の成分表示は</p><div>\[g_i = [A {\bf v}]_{i} = \sum_j A_{ij} v_j\]</div><p>と書ける。つまり、<span>$\psi(x)$</span>を<span>$g_i$</span>、<span>$e^{i k x}$</span>を<span>$A_{ij}$</span>、<span>$c_k$</span>を<span>$v_j$</span>と見なせば、</p><div>\[{\bf \psi} = U {\bf c}\]</div><p>と行列とベクトルを使った解を書くことができる。 そして、異なる固有値に属する固有関数は</p><div>\[{\bf \psi}_n = U {\bf c}_n\]</div><p>となる。これは、線形代数において基底を変換する演算そのものである。なお、この<span>$U$</span>はユニタリー行列である。  </p><p>ここで、線形代数では添字<span>$i$</span>はある離散的な値であったが、座標<span>$x$</span>や<span>$k$</span>は連続的な値であることに注意する必要がある。 ここでは詳しくは述べない。  </p><h4 id="シュレーディンガー方程式の行列表示-1"><a class="docs-heading-anchor" href="#シュレーディンガー方程式の行列表示-1">シュレーディンガー方程式の行列表示</a><a class="docs-heading-anchor-permalink" href="#シュレーディンガー方程式の行列表示-1" title="Permalink"></a></h4><p>さて、座標<span>$x$</span>を離散化し無数の格子点<span>$x_i$</span>に分割したとする。この時、格子点<span>$x_i$</span>での固有値<span>$\epsilon_n$</span>に対する解の値は<span>$\psi_n(x_i)$</span>である。   この<span>$\psi_n(x_i)$</span>は、ベクトル表記ではどのように表せられるだろうか。   実は、ベクトル<span>${\bf x_i}$</span>:</p><div>\[{\bf x}_i^T = (0,0,0,0,0,\cdots,0,1,0,0,\cdots,)\]</div><p>を用意すれば良い。このベクトルの成分表示は</p><div>\[\left[ {\bf x}_i \right]_{\alpha} = \delta_{i\alpha}\]</div><p>である。   このベクトルを使うと、</p><div>\[\psi_n(x_i) = {\bf x} \cdot {\bf \psi}_n\]</div><p>となる。   また、ハミルトニアン<span>$\hat{H}$</span>を格子点上で考える場合には、微分演算子を差分に変更する必要がある。 ある点<span>$x_i$</span>近傍での関数<span>$\psi(x_i \pm a)$</span>は、テイラー展開より</p><div>\[\psi(x_i + a) = \psi(x_i) + \frac{d}{dx}\psi |_{x=x_i} a + \frac{1}{2} \frac{d^2}{dx^2}\psi |_{x=x_i} a^2 + \cdots \]</div><div>\[\psi(x_i - a) = \psi(x_i) - \frac{d}{dx}\psi |_{x=x_i} a + \frac{1}{2} \frac{d^2}{dx^2}\psi |_{x=x_i} a^2 + \cdots\]</div><p>となるので、</p><div>\[\frac{d^2}{dx^2}\psi |_{x=x_i} \sim \frac{\psi(x_i + a) -2\psi(x_i) + \psi(x_i - a)}{a^2}\]</div><p>と微分を差分に直すことができる。一般的には、ある場所<span>$x_i$</span>における微分演算子は、</p><div>\[\frac{d^2}{dx^2}\psi |_{x=x_i} \rightarrow \sum_j d_j \psi(x_j) \]</div><p>と書けるので、シュレーディンガー方程式は、</p><div>\[\sum_j \left(
-\frac{\hbar^2}{2m} d_j + V(x_j) \delta_{ij}
\right) \psi(x_j) = \epsilon \psi(x_i)\]</div><p>と書くことができる。   この方程式は、先ほどと同様に行列とベクトルで表現することができて、</p><div>\[\hat{H} {\bf \psi} = \epsilon {\bf \psi}\]</div><p>となる。これがシュレーディンガー方程式の行列表示である。   ここで、<span>${\bf \psi}_n = U {\bf c}_n$</span>を使えば、</p><div>\[\hat{H} U {\bf c}_n = \epsilon U {\bf c}_n \]</div><div>\[U^+ \hat{H} U {\bf c}_n = \epsilon U^+ U {\bf c}_n \]</div><div>\[\hat{H}&#39; {\bf c}_n = \epsilon {\bf c}_n\]</div><p>となる。</p><p>つまり、<strong>xで表現しようがkで表現しようが、演算子<span>$\hat{H}$</span>に対する固有値問題がシュレーディンガー方程式なのである。</strong>   そこで、特定の<span>${\bf \psi}_n$</span>や<span>${\bf c}_n$</span>を使わずに、ベクトルとしてケットベクトル<span>$|n \rangle$</span> を用いることで、</p><div>\[\hat{H} |n \rangle = \epsilon |n \rangle\]</div><p>とシュレーディンガー方程式を書くことができる。</p><h4 id="座標表示との関係-1"><a class="docs-heading-anchor" href="#座標表示との関係-1">座標表示との関係</a><a class="docs-heading-anchor-permalink" href="#座標表示との関係-1" title="Permalink"></a></h4><p>上記の方程式と元の方程式との関係を見る。 まず、単位行列<span>$\hat{I}$</span>をベクトル<span>${\bf x_j}$</span>で表現すると、</p><div>\[\hat{I} = \sum_j {\bf x_j} {\bf x_j}^T\]</div><p>と書ける。   行列表示の方程式にこの単位行列を挟み、左から<span>${\bf x_i}^T$</span>をかけると、</p><div>\[\sum_j {\bf x_i}^T \hat{H} {\bf x_j} {\bf x_j}^T {\bf \psi} = \epsilon {\bf x_i}^T {\bf \psi} \\
\sum_j \left(
-\frac{\hbar^2}{2m} d_j + V(x_j) \delta_{ij}
\right) \psi(x_j) = \epsilon \psi(x_i)\]</div><p>となり、元の方程式が再現される。   また、基底<span>${\bf \psi}_n$</span>、<span>${\bf c}_n$</span>は、互いにユニタリー変換で結びつけられているため、 ベクトル<span>${\bf x_j}$</span>も様々な基底で表現することができる。よって、これをケットベクトル<span>$|x_i \rangle$</span>と書く。 この時、ある基底で書かれた単位行列は</p><div>\[\hat{I} = \sum_j |x_i \rangle \langle x_i|\]</div><p>と書ける。ここで、<span>$\langle x_i|$</span>はブラベクトルであり、<span>$\langle \alpha | \beta \rangle$</span>はベクトルの内積を表す。 以上から、</p><div>\[\sum_j \langle x_i | \hat{H} |x_j \rangle \langle x_j |n \rangle = \epsilon \langle x_i|n \rangle\]</div><p>が得られる。  </p><p>さて、ここで離散化をやめて元の連続座標<span>$x$</span>について考えると、波動関数<span>$\psi_n(x)$</span>は</p><div>\[\psi_n(x) = \langle x|n \rangle\]</div><p>であり、ハミルトニアンは</p><div>\[H \psi_n(x) = \int dx&#39; \langle x | \hat{H} |x&#39; \rangle \langle x&#39; |n \rangle \]</div><p>となる。  </p><p>つまり、<strong>ベクトル<span>$|n \rangle$</span>に対する座標表示の固有値方程式が、よく見る形のシュレーディンガー方程式だったのである。</strong>   そして、<strong>うまく解けるように適当に基底を選んでシュレディンガー方程式を解くことができる。</strong> それはフーリエ級数展開でも良いし、ベッセル関数でも良いし、チェビシェフ多項式でも良い。</p><h2 id="次元シュレーディンガー方程式の数値的解法-1"><a class="docs-heading-anchor" href="#次元シュレーディンガー方程式の数値的解法-1">1次元シュレーディンガー方程式の数値的解法</a><a class="docs-heading-anchor-permalink" href="#次元シュレーディンガー方程式の数値的解法-1" title="Permalink"></a></h2><p>一番簡単なケースとして、1次元シュレーディンガー方程式を差分化して解いてみよう。   その前に、シュレーディンガー方程式を無次元化しておく。つまり、</p><div>\[\left( -\frac{1}{\sqrt{(2m/\hbar^2)}^2}\frac{d^2}{dx^2} + V(x) \right) \psi(x) = \epsilon \psi(x)\]</div><div>\[\left( -\frac{d^2}{dx&#39;^2} + V(x&#39;) \right) \psi(x&#39;) = \epsilon \psi(x&#39;)\]</div><div>\[x&#39; = x \sqrt{\frac{2m}{\hbar^2}}\]</div><p>としておく。 これにより、計算が容易になる。以後、<span>$x&#39;$</span>は<span>$x$</span>と置き直す。</p><p>x軸を間隔<span>$a$</span>の微小な座標点の集合に書き換えるとする。そして、 二階微分を</p><div>\[\frac{d^2}{dx^2}\psi |_{x=x_i} \sim \frac{\psi(x_i + a) -2\psi(x_i) +\psi(x_i - a)}{a^2}\]</div><p>と差分化する。   この時、シュレーディンガー方程式は</p><div>\[-\frac{1}{a^2} \left(\psi(x_{i+1})+ \psi(x_{i-1}) \right) + \left( \frac{2}{a^2}+  V(x_i) \right)\psi(x_i) = \epsilon \psi(x_i)\]</div><p>となる。  </p><p>座標点の数を<span>$N$</span>とする。   境界条件としては、</p><div>\[\psi(x_{-1}) = 0\]</div><div>\[\psi(x_{N+1}) = 0\]</div><p>とする。つまり、両側が壁に囲まれている。 この時、固有値は</p><div>\[\epsilon = n^2 \frac{\pi^2}{L^2}\]</div><p>である。<span>$L = (N+1)*a$</span>である。</p><p>この時のハミルトニアンを作成するJuliaのコードは以下のようになる。</p><pre><code class="language-julia">function make_H1d(N,a)
    mat_H = zeros(Float64,N,N)
    vec_V = zeros(Float64,N)
        
    for i in 1:N
        for dx in -1:1
            j = i + dx
            v = 0.0
            if dx == 0
                v = (2/a^2 + vec_V[i])
            elseif dx == 1
                v = -1/a^2
            elseif dx == -1
                v = -1/a^2
            end
            
            if 1 &lt;= j &lt;= N
                mat_H[i,j] = v
            end
            
        end
        
    end
    
    
    return mat_H
end</code></pre><p>この行列を対角化し、固有値の分布を出してみよう。  </p><p>まず、プロット用のmoduleを読み込む。</p><pre><code class="language-julia">using Plots
gr()</code></pre><p>Nをいろいろいじってプロットしてみよう。縦軸が非常に大きいことに注意。</p><pre><code class="language-julia">using LinearAlgebra #対角化のルーチンeigenを呼ぶ準備 v0.7以降必要

N = 1000
a = 0.01
mat_H = make_H1d(N,a)
ε,ψ = eigen(mat_H)

integers = Int64[]
for i in 1:N
    push!(integers,i)
end

plot(integers[1:N],ε[1:N],label=&quot;1D&quot;) 
</code></pre><p><img src="figs/fig01.png" alt="fig1"/> </p><pre><code class="language-julia">sn = 200
plot(integers[1:sn],ε[1:sn],label=&quot;1D&quot;,marker=:circle) </code></pre><p><img src="figs/fig02.png" alt="fig1"/> </p><p>解析解：</p><div>\[\epsilon = n^2 \frac{\pi^2}{ (a(N+1))^2}\]</div><p>と重ねてみよう。</p><pre><code class="language-julia">εa = Float64[]
for n in 1:N
    push!(εa,n^2*π^2/(a*(N+1))^2)
end

plot(integers[1:sn],[ε[1:sn],εa[1:sn]],label=[&quot;Numerical result&quot;,&quot;Analytical result&quot;],marker=:circle) </code></pre><p><img src="figs/fig03.png" alt="fig1"/> </p><p>高エネルギー領域では、ずれる。</p><pre><code class="language-julia">sn = 1000
plot(integers[1:sn],[ε[1:sn],εa[1:sn]],label=[&quot;Numerical result&quot;,&quot;Analytical result&quot;],marker=:circle) </code></pre><p><img src="figs/fig04.png" alt="fig1"/> </p><p>高エネルギーでずれる原因を考える。   今、空間を差分化しており、その間隔<span>$a$</span>より小さい長さスケールのものは記述できない。   つまり、波数<span>$k_{\rm MAX} = 1/a$</span>より大きな波数の物理は記述できない。   この時のエネルギーは、</p><div>\[\epsilon = k_{\rm MAX}^2 = 1/a^2 \]</div><p>である。従って、<span>$a=0.01$</span>の時は、<span>$\epsilon &gt; 10000$</span>の領域がずれることになる。   もし、a = 0.1とすると、</p><pre><code class="language-julia">N = 1000
a = 0.1
mat_H = make_H1d(N,a)
ε,ψ = eigen(mat_H)

integers = Int64[]
for i in 1:N
    push!(integers,i)
end

sn = 400
εa = Float64[]
for n in 1:N
    push!(εa,n^2*π^2/(a*(N+1))^2)
end

plot(integers[1:sn],[ε[1:sn],εa[1:sn]],label=[&quot;Numerical result&quot;,&quot;Analytical result&quot;],marker=:circle) </code></pre><p><img src="figs/fig05.png" alt="fig1"/> </p><p>エネルギーが100以上の部分は合わないことになる。</p></article></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 13 February 2020 10:28">Thursday 13 February 2020</span>. Using Julia version 1.3.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
